---
title: "Algo_STAT6443_HW1"
author: "Jerris George"
date: "9/11/2021"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(e1071)
```

## Excercise 1: Descriptive Statistics

## Exercise 1A: Process

1. Begin by loading cars data into environment as a data frame (d1).
2. Perform basic inspection of data frame, along with a descriptive statistic.
3. Create new data frame (d2) which the mutate function will be used to create 
the MPG_Combo variable.Then check summary function. See comment # 3 below.
**Note: This fulfills the 1st requirement of exercise 1A.**
4. The below box plot shows initial evidence that the combined mpg is  
not symmetrical. Since the mean is slightly above the median in the box plot.
Then the combined mpg data is right skewed. Thus the data may not follow the 
normal distribution. 

To conclude, there is evidence that the combined mpg is not equal across the
data range. Therefore fuel efficiency may be different. We also see evidence of
outliers from the box plot.
**Note: This fulfills the 2nd requirement of exercise 1A.**

```{r}
# 1
d1 = read.csv("C:/UTSA/Fall2021/STA6443-Algorithms-1/HW1/CARS.csv", header = T)

# 2 
str(d1)
class(d1)

# 3
d2 = mutate(d1, MPG_Combo = (0.6*MPG_City)+(0.4*MPG_Highway))
summary(d2$MPG_Combo)

# 4 
boxplot(d2$MPG_Combo, ylab = "MPG_Combo"); 
points(mean(d2$MPG_Combo, na.rm = T), col = "red", pch = 2) 

```

## Exercise 1B: Process

1. Create new data frames to hold subsets of (d2) based on type.
2. Create Boxplots by type. SUV appears slightly right skewed(mean > median),
Sedan appears slightly right skewed(mean > median) with outliers, Sports 
appears very slightly right skewed(mean > median) with some outliers, Trucks 
appears right skewed(mean > median) with some outliers, and Wagon appears
right skewed (mean > median).


To Conclude: The plots show that SUV and Trucks possess the  
lowest combined MPG but as expected next would be Sports Cars, and then 
Sedan/Wagons.
**Note: This fulfills the requirement of exercise 1B.**

```{r}
# 1
d_suv = subset(d2, Type == "SUV")
d_sedan = subset(d2, Type == "Sedan")
d_sports = subset(d2, Type == "Sports")
d_truck = subset(d2, Type == "Truck")
d_wagon = subset(d2, Type == "Wagon")

# 2
par(mfrow=c(1,5))
boxplot(d_suv$MPG_Combo, main = "SUV", ylab = "Combined MPG Of SUV"); 
points(mean(d_suv$MPG_Combo, na.rm = T), col = "blue", pch = 2) 
boxplot(d_sedan$MPG_Combo, main = "Sedan", ylab = "Combined MPG Of Sedan"); 
points(mean(d_sedan$MPG_Combo, na.rm = T), col = "red", pch = 2) 
boxplot(d_sports$MPG_Combo, main = "Sports", ylab = "Combined MPG Of Sports"); 
points(mean(d_sports$MPG_Combo, na.rm = T), col = "green", pch = 2) 
boxplot(d_truck$MPG_Combo, main = "Trucks", ylab = "Combined MPG Of Trucks"); 
points(mean(d_truck$MPG_Combo, na.rm = T), col = "blue", pch = 2)
boxplot(d_wagon$MPG_Combo, main = "Wagon", ylab = "Combined MPG Of Wagon"); 
points(mean(d_wagon$MPG_Combo, na.rm = T), col = "green", pch = 2)
```

## Exercise 1C: Process

1. Prepare a data frame that arranges the previous data frame from greatest
to least horsepower. Then perform an initial descriptive statistic using the
summary function. Additional Basic descriptive check seen in next step.
**Note: This fulfills the 1st requirement of exercise 1C.**
2. Basic Descriptive check. See comments below.
3. Visual or Qualitative Check. See comments below.
4. The qq plot shows evidence that although in the center the data follows,
see additional comments below.
**Note: This fulfills the 2nd requirement of exercise 1C.**
5. Quantitative Check. See comments below. 
**Note: This fulfills the 3rd requirement of exercise 1C.**

```{r}
# 1
d3 = arrange(d2, desc(Horsepower))
summary(d3$Horsepower)

# 2
# The mean is 216.76 which is > the median,showing evidence of right skewing.
# This initially lets us see that their is evidence that the data does not 
# follow the normal distribution.
mean(d3$Horsepower, na.rm = T)
# The median is 210 which is less than the mean.
median(d3$Horsepower, na.rm = T)
# The variance or sigma squared is 5085.952
var(d3$Horsepower, na.rm = T)
# The standard deviation, sigma is 71.31586
sd(d3$Horsepower, na.rm = T) 
# The skew is 0.95 which is > 0, showing evidence of right skewing.
skewness(d3$Horsepower, na.rm = T) 
# The range gives us the Min = 100 and the Max = 500. The Min < Q1 and 
#the Max is > than Q3. Evidence of outliers exist, because the Max is far 
#greater than Q3 and the min is a bit less than Q1.
range(d3$Horsepower, na.rm = T) 

#3
#histogram shows evidence of right skewing 
hist(d3$Horsepower, main = "Horsepower", xlab = "Horsepower") 
# The  box plot skew is seen as toward the right as the mean 
# can be seen to be affected by outliers.
boxplot(d3$Horsepower, main = "Horsepower", ylab = "Horsepower"); 
points(mean(d3$Horsepower, na.rm = T), col = "green", pch =2)

# 4.
# the normal distribution line on the upper range it does not therefore, 
# we see evidence that the data does not appear normal.
# Visual conclusion: We see evidence based on our visual and qualitative 
# checks that Horsepower might not follow a normal distribution.
qqnorm(d3$Horsepower, main = "Normal vs Horsepower"); 
qqline(d3$Horsepower, col = 2) 


## 5.
# Using the shapiro test we can quantitatively obtain the P-Value.
# The P-Value = 0.0000000000232 which is < 0.05. 
# Quantitative Check conclusion: Based on the above we have enough evidence to 
# reject the null hypothesis, thus our conclusion is that the data does not 
# follow a normal distribution. Horsepower does not follow a 
# normal distribution.
shapiro.test(d3$Horsepower) 
```

## Exercise 1D: Process

1. Create new data frames to hold subsets of (d3) based on type.
2. Summary statistics of each type and basic statistics. See comments below.
3. Visual or Qualitative checks using Histogram/Density Plots/BoxPlots/QQ-Plots
See comments below.
Visual conclusion: We see evidence based on our visual or qualitative,
checks that Horsepower of each type might not follow a normal distribution.
**Note: This fulfills the 1st requirement of exercise 1D.**
4. Quantitative Check/Shapiro.test. See comments below.
Quantitative conclusion: 
Horsepower of SUV does not follow a normal distribution.
Horsepower of Sports does not follow a normal distribution.
Horsepower of Truck does not follow a normal distribution.
**Note: This fulfills the 2nd requirement of exercise 1D.**

```{r}
# 1
d_suv2 = subset(d3, Type == "SUV")
d_sports2 = subset(d3, Type == "Sports")
d_truck2 = subset(d3, Type == "Truck")


# 2

# Summary statistics of Sports Car Type
summary(d_sports2$Horsepower) 
# The mean is 284.1633 which is < the median,showing evidence of Left skewing
mean(d_sports2$Horsepower, na.rm = T) 
# The median is 287
median(d_sports2$Horsepower, na.rm = T)
# The variance is 8609.931
var(d_sports2$Horsepower, na.rm = T) 
# The standard deviation, sigma is 92.78971
sd(d_sports2$Horsepower, na.rm = T)
# The skew is 0.6601324 which is > 0, showing evidence of right skewing
skewness(d_sports2$Horsepower, na.rm = T) 
# The Min is 138 and the Max is 500  
range(d_sports2$Horsepower, na.rm = T) 

# Summary statistics of SUV Car Type
summary(d_suv2$Horsepower) 
# The mean is 235.8167 which is > the median,showing evidence of Right skewing
mean(d_suv2$Horsepower, na.rm = T)
# The median is 231
median(d_suv2$Horsepower, na.rm = T) 
# The variance is 3162.254
var(d_suv2$Horsepower, na.rm = T) 
# The standard deviation, sigma is 56.23392
sd(d_suv2$Horsepower, na.rm = T) 
# The skew is 0.05479783 which is > 0, showing evidence of right skewing
skewness(d_suv2$Horsepower, na.rm = T) 
# The Min is 130 and the Max is 340 
range(d_suv2$Horsepower, na.rm = T)


# Summary statistics of Truck Car Type
summary(d_truck2$Horsepower) 
# The mean is 224.8333 which is > the median,showing evidence of Right skewing.
mean(d_truck2$Horsepower, na.rm = T) 
# The median is 208.5
median(d_truck2$Horsepower, na.rm = T) 
# The variance is 3824.841
var(d_truck2$Horsepower, na.rm = T)
# The standard deviation, sigma is 61.8453
sd(d_truck2$Horsepower, na.rm = T) 
# The skew is 0.3771641 which is > 0, showing evidence of right skewing
skewness(d_truck2$Horsepower, na.rm = T)
# The Min is 142 and the Max is 345
range(d_truck2$Horsepower, na.rm = T)


# 3

# SUV is harder to tell but appears closer to normal distribution.
# Sports car appears to be slightly right skewed.
# Truck appears to be right skewed.

par(mfrow=c(2,3))
hist(d_suv2$Horsepower, main = "SUV", xlab = "HP of SUV") 
hist(d_sports2$Horsepower, main = "Sports", xlab = "HP of Sports") 
hist(d_truck2$Horsepower, main = "Truck", xlab = "HP of Trucks")

plot(density(d_suv2$Horsepower), main = "SUV")
plot(density(d_sports2$Horsepower), main = "Sports")
plot(density(d_truck2$Horsepower), main = "Truck")


# BoxPlots
# SUV appears to be right skewed.
# Sports appears to be slight left skewed.
# Trucks appears to be right skewed.
par(mfrow=c(1,3))
boxplot(d_suv2$Horsepower, main = "SUV", ylab = "HP of SUV"); 
points(mean(d_suv2$Horsepower, na.rm = T), col = "red", pch =2)

boxplot(d_sports2$Horsepower, main = "Sports", ylab = "HP of Sports"); 
points(mean(d_sports2$Horsepower, na.rm = T), col = "red", pch =2)

boxplot(d_truck2$Horsepower, main = "Trucks", ylab = "HP of Trucks"); 
points(mean(d_truck2$Horsepower, na.rm = T), col = "red", pch =2)


# QQ-Plots

# The qq plots shows evidence that  the data does not follow 
# the normal distribution line as we see evidence that the data does not 
# appear normal.
# Visual conclusion: We see evidence based on our visual and qualitative,
# checks that Horsepower of each type might not follow a normal distribution.
par(mfrow=c(1,3))
qqnorm(d_suv2$Horsepower, main = "Normal vs. SUV"); 
qqline(d_suv2$Horsepower, col = 2) 
qqnorm(d_sports2$Horsepower, main = "Normal vs. Sports"); 
qqline(d_sports2$Horsepower, col = 2) 
qqnorm(d_truck2$Horsepower, main = "Normal vs. Truck"); 
qqline(d_truck2$Horsepower, col = 2) 

# 4

# SUV P-Value = 0.004423 which is < 0.05 based on the above we have enough 
# evidence to reject the null hypothesis, thus our conclusion is that the 
# data does not follow a normal distribution
# Horsepower of SUV does not follow a normal distribution.
shapiro.test(d_suv2$Horsepower) 



# Sports P-Value = 0.01898 which is < 0.05 based on the above we have enough 
# evidence to reject the null hypothesis, thus our conclusion is that the data 
# does not follow a normal distribution
# Horsepower of Sports does not follow a normal distribution.
shapiro.test(d_sports2$Horsepower) 



# Truck P-Value = 0.01697 which is < 0.05
# based on the above we have enough evidence to reject the null hypothesis,
# thus our conclusion is that the data does not follow a normal distribution
# Horsepower of Truck does not follow a normal distribution.
shapiro.test(d_truck2$Horsepower) 
```

## Excercise 2: Hypothesis Testing of SUV vs. Truck 

## Exercise 2A: Process

1. Based on our findings in exercise 1B, we would need to compare the 
median value of SUV to the median value of Truck.
This along with other statistics can be used to determine if they are 
different or the same. For this reason we will perform the Two-Sample
of population difference and by default we can do the Two-sided test
we choose this test based on previous evidence that: they have similarities but
it would be good to see if they have the same Horsepower or not.
Below is some brief statistics to recap of descriptive, qualitative, and
quantitative checks. This is used because we can directly isolate the two types.
This will generate a stronger argument. While this is extra it illustrates and
helps justify the need for the test of two sample population difference.
See comments below.
**Note: This fulfills the requirement of exercise 2A.**

```{r}
# 1
SUV_TRUCK = subset(d3, Type == "SUV" | Type == "Truck")

# median of SUV is very different is very different than median of Truck.
summary(d_suv2$Horsepower)
summary(d_truck2$Horsepower)

# boxplot compares Horsepower of SUV to Horsepower of Truck
# we can see that the median and distribution is different.
boxplot(Horsepower ~ Type, data = SUV_TRUCK, 
        main = "Horsepower by Type" )

# combined histograms and qq plots
par(mfrow=c(2,2))
hist(SUV_TRUCK$Horsepower[SUV_TRUCK$Type == "SUV"], 
     main = "Horsepower of SUV")
hist(SUV_TRUCK$Horsepower[SUV_TRUCK$Type == "Truck"], 
     main = "Horsepower of Truck")

qqnorm(d_truck2$Horsepower, main = "Normal vs. Truck");
qqline(d_truck2$Horsepower, col = 2) 
qqnorm(d_suv2$Horsepower, main = "Normal vs. SUV"); 
qqline(d_suv2$Horsepower, col = 2) 

# quantitative test of Horsepower of SUV and Horsepower of Truck

shapiro.test(d_suv2$Horsepower) 
shapiro.test(d_truck2$Horsepower) 
```

## Null and alternative hypothesis
## Exercise 2B: Hypothesis Statement

1. Stating the null and alternative hypothesis. Since we know they do not follow
the normal distribution and there are clear evidence of outliers, we must use 
the median instead of mean, since it is more robust. 
See comments below.
**Note: This fulfills the requirement of exercise 2B.**

```{r}
# 1
# Two-sided check:
# Null: medianHPofSUV = medianHPofTruck or 
# i.e. the median Horsepower of SUV = to the median Horsepower of Truck
# Alternative: medianHPofSUV != medianHPofTruck or Horsepower of SUV 
# is different than Horsepower of Truck.
# A one-sided check would consider the alternative of one population being
# greater than the the other or less than the other.
# We can perform either but we will use the default to find the P-Value
```

## Excercise 2C: Conclusion

1. Based on data obtained in 1d they both do not follow the normal distribution
Therefore we must perform the Wilcoxon rank-sum test.
We can see based on the results that the evidence shows that 
P-Vale is 0.3942 therefore we cannot reject the null hypothesis.
We can conclude that there is evidence that Horsepower of SUV is the 
same as the Horsepower of Truck. 

Preliminary finding:
Shapiro-Wilk test shows P-Value of July = 0.1564
Shapiro-Wilk test shows P-Value of Aug = 0.937
Since both values are greater than 0.05 we do not have enough evidence
to reject the null hypothesis.

**Note: This fulfills the requirement of exercise 2C.**

```{r}
# 1

# We can see based on the results that the evidence shows that 
# P-Vale is 0.3942 therefore we cannot reject the null hypothesis.

wilcox.test(Horsepower ~ Type, data = SUV_TRUCK, exact = FALSE)
```

## Excercise 3: Hypothesis Testing of wind speed for July and August

## Excercise 3A: Process 

1. We would need to compare the mean value of wind in July to the mean value of 
wind in August. These are thus two populations.
This along with other statistics can be used to determine if they are 
different or the same. For this reason we will perform the Two-Sample
of population difference and by default we can do the Two-sided test
Then we prepare data and perform checks. 
See comments below.
**Note: This fulfills the requirement of exercise 3A.**

```{r}
# 1

# load and store air quality data
aq = data.frame(airquality)
#summary(aq_julyaug$Wind)
# create subset of july and august air quality data, separated and combined
aq_july = subset(aq, Month == 7)
aq_aug = subset(aq, Month == 8)
aq_julyaug = subset(aq, Month == 7 | Month == 8)


## Visual Check shows that while august follows the normal distribution
# July does not completely follow the normal distribution.
par(mfrow=c(1,2))
qqnorm(aq_july$Wind, main = "Normal vs. Wind in July")
qqline(aq_july$Wind, col = "red")
qqnorm(aq_aug$Wind, main = "Normal vs. Wind in Aug")
qqline(aq_aug$Wind, col = "red")

# Combined you can see that they don't completely follow the normal 
# distribution. Therefore we see evidence that it may be possible that the
# data is not normal but we should perform a quantitative check to confirm.
qqnorm(aq_julyaug$Wind, main = "Normal vs. Wind in July and Aug");
qqline(aq_julyaug$Wind, col = "red")

## Quantitative check using the Shapiro-Wilk test to check for normality
# Shapiro-Wilk test shows P-Value of July = 0.1564
# Shapiro-Wilk test shows P-Value of Aug = 0.937
# Since both values are greater than 0.05 we do not have enough evidence
# to reject the null hypothesis.

shapiro.test(aq_july$Wind)
shapiro.test(aq_aug$Wind)
```

## Null and Alternative hypothesis
## Excercise 3B: Hypothesis Statement

1. Stating the null and alternative hypothesis. See comments below.
Null: meanwindspeedJuly = meanwindspeedAugust or 
Wind speed of July = to Wind speed of August.

Alternative: meanspeedwindJuly != meanspeedwindJuly or Wind speed of 
July is different than Wind speed of August.
**Note: This fulfills the requirement of exercise 3B.**

```{r}
# 1
# Null: meanwindspeedJuly = meanwindspeedAugust or 
# i.e. Wind speed of July = to Wind speed of August
# Alternative: meanwindJuly != meanwindJuly or Wind speed of July is different 
# than Wind speed of August.
# A one-sided check would consider the alternative of one population being
# greater than the the other or less than the other.
# We can perform either but we will use the default to find the P-Value
```

##  Excercise 3C: Conclusion

1. We saw from 3a that we do not have enough evidence to reject the null as
the data appears to follow the normal distribution and normality is seen.
We therefore must then begin by checking for equal variance. To do so we will
use the equal variance test var.test()
See comments below. 

2. Equal-Variance: P-Value = 0.7418 is large therefore we cannot reject the null
hypothesis. We must therefore perform the Pooled t-test.Perform Pooled t.test 
using equal variance. 

3. Conclusion: The Pooled t-test P-Value = 0.8527 is large therefore we cannot 
reject the mull hypothesis. We can conclude that we have evidence that the 
Wind speed of July is equal to the Wind speed of August. We can conclude that 
we see evidence that the mean Wind speed of July is equal to the mean 
Wind speed of August.

**Note: This fulfills the requirement of exercise 3C.**
```{r}
# 1

# Equal-Variance: P-Value = 0.7418 is large therefore we cannot reject the null
# hypothesis. We must therefore perform the Pooled t-test.
var.test(Wind ~ Month, data = aq_julyaug,
         alternative = "two.sided")

# Pooled t-test P-Value = 0.8527 is large therefore we cannot reject the mull
# hypothesis. We can conclude that we have evidence that the mean Wind speed of 
# July is equal to the mean Wind speed of August.
t.test(Wind ~ Month, data = aq_julyaug,
       alternative = "two.sided",
       var.equal = TRUE)
```

